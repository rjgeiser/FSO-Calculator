<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="description" content="Foreign Service Officer Separation Benefits Calculator - Calculate severance pay, FSPS annuity, and health insurance options">
    <meta name="author" content="Roy Geiser">
    <meta name="developer" content="Roy Geiser - Foreign Service Benefits Calculator">
    <meta name="theme-color" content="#2c5282">
    <title>FSO Benefits Calculator</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="./img/icon-192.png">
    
    <!-- PWA Support -->
    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="./img/icon-192.png">
    
    <!-- Performance Optimization: Preload Critical Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                    console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>

    <style>
        /* Critical CSS for above-the-fold content */
        :root {
            --primary-color: #2b6cb0;
            --secondary-color: #4a5568;
            --background-color: #f0f5fa;
            --border-color: #e2e8f0;
            --error-color: #c53030;
            --success-color: #2f855a;
            --focus-ring-color: #4299e1;
            --focus-ring-width: 3px;
        }

        /* Modern Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        /* Accessibility Improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }

        /* Focus Styles */
        :focus {
            outline: 3px solid var(--primary-color);
            outline-offset: 2px;
        }

        :focus:not(:focus-visible) {
            outline: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #1a365d;
            background-color: #f0f5fa;
            padding: 1rem;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Main Layout */
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
            width: 100%;
        }

        .form-column,
        .results-column {
            min-width: 0;
        }

        /* Form and Results Sections */
        .form-section,
        .results-section {
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            height: 100%;
            margin-bottom: 1rem;
        }

        .form-section {
            border-right: 1px solid #e2e8f0;
        }

        /* Form Layout */
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -0.5rem;
            margin-left: -0.5rem;
            margin-bottom: 0.75rem;
        }

        .form-group {
            position: relative;
            width: 100%;
            padding-right: 0.5rem;
            padding-left: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .col-md-6 {
            flex: 0 0 50%;
            max-width: 50%;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e2e8f0;
            grid-column: 1 / -1;
        }

        .header h1 {
            color: #2c5282;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: #4a5568;
            font-size: 1rem;
        }

        /* Form Controls */
        .form-control {
            width: 100%;
            padding: 0.625rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            transition: all 0.2s ease;
            background-color: white;
            height: 2.75rem;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 0.95rem;
            line-height: 1.5;
            color: #2d3748;
        }

        .form-text {
            font-size: 0.8rem;
            color: #718096;
            margin-top: 0.25rem;
        }

        /* Results Container */
        .results-container {
            opacity: 1;
            transform: none;
            transition: none;
            padding-left: 0.75rem;
            display: block;
        }

        .results-container.visible {
            opacity: 1;
            transform: none;
        }

        .tab-content {
            margin-bottom: 2rem;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Results Section */
        .results-section {
            display: none; /* Hidden by default */
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            height: 100%;
            margin-bottom: 1rem;
        }

        .comparison-table {
            width: 100%;
            margin-bottom: 2rem;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #2d3748;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table td:first-child {
            font-weight: 500;
            color: #4a5568;
        }

        /* Buttons */
        .form-actions {
            display: flex;
            justify-content: flex-start;
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e2e8f0;
        }

        .btn {
            padding: 0.5rem 1.5rem;
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            color: white;
            background: #2b6cb0;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        /* Tabs */
        .tabs {
            margin-bottom: 1rem;
        }

        .tab-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: #f7fafc;
            border-radius: 8px;
        }

        .tab-button {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            color: #4a5568;
            transition: all 0.2s ease;
        }

        .tab-button:hover {
            background: #e2e8f0;
        }

        .tab-button.active {
            background: #2b6cb0;
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Results Layout */
        .benefit-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            padding: 0.75rem;
        }

        .benefit-section {
            background: #f7fafc;
            padding: 1.25rem;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .benefit-item {
            margin-bottom: 0.75rem;
        }

        .benefit-item:last-child {
            margin-bottom: 0;
        }

        .benefit-item h4 {
            color: #2c5282;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .benefit-item h5 {
            color: #4a5568;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .benefit-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2d3748;
        }

        /* Dark mode adjustments */
        body.dark-mode .tab-buttons {
            background: #2d3748;
        }

        body.dark-mode .tab-button {
            color: #e2e8f0;
        }

        body.dark-mode .tab-button:hover {
            background: #4a5568;
        }

        body.dark-mode .benefit-section {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .benefit-item h4 {
            color: #e2e8f0;
        }

        body.dark-mode .benefit-item h5 {
            color: #a0aec0;
        }

        body.dark-mode .benefit-amount {
            color: #e2e8f0;
        }

        /* Loading state improvements */
        .loading-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
                display: flex;
                flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Media Queries */
        @media (max-width: 1200px) {
            .content-wrapper {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
                margin-bottom: 2rem;
            }
        }

        @media (max-width: 600px) {
            .container {
                padding: 0.5rem;
            }

            .content-wrapper {
                gap: 1rem;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --background-color: #1a202c;
                --text-color: #e2e8f0;
                --border-color: #4a5568;
            }

            body {
                background-color: var(--background-color);
                color: var(--text-color);
            }

            .form-control {
                background-color: #2d3748;
                color: var(--text-color);
                border-color: var(--border-color);
            }

            .form-section {
                background-color: #2d3748;
            }

            .comparison-table th {
                background-color: #2d3748;
            }
        }

        /* Dark mode toggle */
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .theme-toggle svg {
            width: 20px;
            height: 20px;
        }

        /* Dark mode specific styles */
        body.dark-mode {
                background-color: #1a202c;
                color: #e2e8f0;
        }

        body.dark-mode .container {
            background: #2d3748;
        }

        body.dark-mode .form-section,
        body.dark-mode .results-section,
        body.dark-mode .form-container,
        body.dark-mode .results-container,
        body.dark-mode .tabs,
        body.dark-mode .tab-content,
        body.dark-mode .retirement-scenario,
        body.dark-mode .benefit-summary,
        body.dark-mode .benefit-section,
        body.dark-mode .comparison-table,
        body.dark-mode .comparison-table th,
        body.dark-mode .comparison-table td,
        body.dark-mode .form-control,
        body.dark-mode select.form-control option,
        body.dark-mode .alert,
        body.dark-mode .alert-warning,
        body.dark-mode .alert-success,
        body.dark-mode .alert-danger,
        body.dark-mode .alert-info,
        body.dark-mode .tooltip-text,
        body.dark-mode .validation-message,
        body.dark-mode .guidance-note,
        body.dark-mode .form-text,
        body.dark-mode .disclaimer {
            background: #2d3748;
                border-color: #4a5568;
            color: #e2e8f0;
        }

        body.dark-mode .form-control:focus {
            border-color: #4299e1;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }

        body.dark-mode .form-control:disabled,
        body.dark-mode .form-control[readonly] {
                background-color: #1a202c;
            color: #a0aec0;
        }

        body.dark-mode .form-control::placeholder {
            color: #718096;
        }

        body.dark-mode .header {
            background-color: #2d3748;
                color: #e2e8f0;
            }

        body.dark-mode .header h1 {
            color: #e2e8f0;
        }

        body.dark-mode .header p {
            color: #a0aec0;
        }

        body.dark-mode .form-section h3,
        body.dark-mode .results-section h3,
        body.dark-mode .benefit-item h4 {
            color: #e2e8f0;
        }

        body.dark-mode .benefit-item h5 {
            color: #a0aec0;
        }

        body.dark-mode .benefit-amount {
            color: #4299e1;
        }

        body.dark-mode .tab-buttons {
            background: #2d3748;
        }

        body.dark-mode .tab-button {
            color: #e2e8f0;
        }

        body.dark-mode .tab-button:hover {
            background: #4a5568;
        }

        body.dark-mode .tab-button.active {
            background: #4299e1;
            color: #ffffff;
        }

        body.dark-mode .btn {
            background: #4a5568;
        }

        body.dark-mode .btn:hover {
            background: #2d3748;
        }

        body.dark-mode .btn-secondary {
            background: #4a5568;
        }

        body.dark-mode .btn-secondary:hover {
            background: #2d3748;
        }

        body.dark-mode footer {
            color: #a0aec0;
        }

        body.dark-mode footer a {
            color: #4299e1;
        }

        body.dark-mode footer a:hover {
            color: #3182ce;
        }

        body.dark-mode .form-text,
        body.dark-mode .guidance-note small {
            color: #a0aec0;
        }

        body.dark-mode .validation-message {
            color: #f56565;
        }

        body.dark-mode .retirement-type-info {
            background: #2d3748;
            border-color: #4a5568;
        }

        body.dark-mode .retirement-type-info h4 {
            color: #e2e8f0;
        }

        body.dark-mode .eligibility-info {
            color: #a0aec0;
        }

        body.dark-mode .eligibility-info strong {
            color: #e2e8f0;
        }

        body.dark-mode .disclaimer {
            background-color: rgba(66, 153, 225, 0.1);
            border: 1px solid #4299e1;
        }

        body.dark-mode .disclaimer strong {
            color: #4299e1;
        }

        body.dark-mode .disclaimer p {
            color: #e2e8f0;
        }

        body.dark-mode .form-actions {
            border-top-color: #4a5568;
        }

        body.dark-mode .service-duration-warning {
            background-color: transparent;
            border: none;
        }

        body.dark-mode .service-duration-warning .btn-primary {
            background: #2b6cb0;
        }

        body.dark-mode .service-duration-warning .btn-primary:hover {
            background: #2c5282;
        }

        /* Form Element Typography Consistency */
        input,
        select,
        textarea,
        .form-control,
        button {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 0.95rem;
            line-height: 1.5;
            color: #2d3748;
        }

        /* Labels */
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-weight: 500;
            font-size: 0.95rem;
            color: #2d3748;
            line-height: 1.4;
        }

        /* Select specific styles */
            select.form-control {
            padding-right: 2.5rem;
            cursor: pointer;
            background-color: white;
        }

        /* Dark mode adjustments */
        body.dark-mode select.form-control {
            background-color: #2d3748;
            color: #e2e8f0;
        }

        /* Option text in dropdowns */
        select.form-control option {
            font-size: 0.95rem;
            padding: 0.5rem;
            background-color: white;
        }

        body.dark-mode select.form-control option {
            background-color: #2d3748;
            color: #e2e8f0;
        }

        /* Helper text consistency */
        .form-text,
        .guidance-note small,
        .tooltip-text {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 0.85rem;
            line-height: 1.4;
            color: #718096;
        }

        /* Section headers */
        .form-section h3 {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c5282;
            margin-bottom: 1rem;
        }

        /* Focus states */
        .form-control:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
        }

        /* Placeholder text */
        .form-control::placeholder {
            color: #a0aec0;
            font-size: 0.95rem;
        }

        /* Dark mode adjustments */
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea,
        body.dark-mode .form-control {
            background-color: #2d3748;
            color: #e2e8f0;
            border-color: #4a5568;
        }

        body.dark-mode label {
            color: #e2e8f0;
        }

        body.dark-mode .form-text,
        body.dark-mode .guidance-note small,
        body.dark-mode .tooltip-text {
            color: #a0aec0;
        }

        body.dark-mode .form-control::placeholder {
            color: #718096;
        }

        /* Validation states */
        .form-control:invalid {
            border-color: #fc8181;
        }

        .form-control:invalid:focus {
            border-color: #fc8181;
            box-shadow: 0 0 0 3px rgba(252, 129, 129, 0.15);
        }

        /* Disabled states */
        .form-control:disabled,
        .form-control[readonly] {
            background-color: #edf2f7;
            opacity: 0.7;
            cursor: not-allowed;
        }

        body.dark-mode .form-control:disabled,
        body.dark-mode .form-control[readonly] {
            background-color: #1a202c;
        }

        /* Consistent spacing */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-row {
            margin-bottom: 0.75rem;
        }

        /* Date input specific styles */
        input[type="date"].form-control {
            min-height: 2.75rem;
        }

        /* Number input specific styles */
        input[type="number"].form-control {
            min-height: 2.75rem;
        }

        /* Remove spinner buttons from number inputs */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="number"] {
            -moz-appearance: textfield;
        }

        .results-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #ffffff;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .results-section h3 {
            color: #2c5282;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .retirement-scenario {
            margin-bottom: 1.5rem;
        }
        
        /* Disclaimer styles */
        .disclaimer {
            background-color: rgba(66, 153, 225, 0.1);
            border: 1px solid #4299e1;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .disclaimer strong {
            color: #2b6cb0;
        }

        .disclaimer p {
            margin: 0;
            color: #2d3748;
        }

        /* Report Tab Styles */
        .benefit-section {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            padding: 1.5rem;
        }

        .benefit-section h4 {
            color: #2c3e50;
            margin-bottom: 1.25rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e2e8f0;
        }

        .comparison-table {
            width: 100%;
            margin: 1rem 0;
        }

        .comparison-table table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 0.5rem;
        }

        .comparison-table th {
            text-align: left;
            color: #4a5568;
            font-weight: 600;
            padding: 0.75rem;
            background: #f7fafc;
            border-radius: 4px 0 0 4px;
        }

        .comparison-table td {
            padding: 0.75rem;
            background: #f7fafc;
            border-radius: 0 4px 4px 0;
            font-weight: 500;
        }

        .calculation-details {
            background: #f8fafc;
            border-radius: 6px;
            padding: 1.25rem;
            margin-top: 1rem;
        }

        .calculation-details h5 {
            color: #2d3748;
            margin: 1rem 0 0.5rem;
            font-size: 1.1rem;
        }

        .calculation-details ul {
            list-style-type: none;
            padding-left: 0;
        }

        .calculation-details li {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .calculation-details li:before {
            content: "•";
            color: #4a5568;
            position: absolute;
            left: 0;
        }

        .benefit-amount {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2d3748;
        }

        .retirement-scenario {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            padding: 1.5rem;
        }

        .retirement-scenario h4 {
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .scenario-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .scenario-details p {
            margin: 0.5rem 0;
        }

        .scenario-details strong {
            color: #4a5568;
        }

        /* Dark mode adjustments */
        .dark-mode .benefit-section,
        .dark-mode .retirement-scenario {
            background: #2d3748;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .dark-mode .benefit-section h4,
        .dark-mode .retirement-scenario h4 {
            color: #e2e8f0;
            border-bottom-color: #4a5568;
        }

        .dark-mode .comparison-table th,
        .dark-mode .comparison-table td {
            background: #2d3748;
            color: #e2e8f0;
        }

        .dark-mode .calculation-details {
            background: #2d3748;
        }

        .dark-mode .calculation-details h5 {
            color: #e2e8f0;
        }

        .dark-mode .calculation-details li:before {
            color: #a0aec0;
        }

        .dark-mode .benefit-amount {
            color: #e2e8f0;
        }

        .dark-mode .scenario-details strong {
            color: #a0aec0;
        }

        /* Tab styling improvements */
        .tab-content {
            padding: 1.5rem;
            background: #f7fafc;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .dark-mode .tab-content {
            background: #1a202c;
        }

        .tab-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            background: #e2e8f0;
            color: #4a5568;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab-button:hover {
            background: #cbd5e0;
        }

        .tab-button.active {
            background: #4299e1;
            color: white;
        }

        .dark-mode .tab-button {
            background: #2d3748;
            color: #e2e8f0;
        }

        .dark-mode .tab-button:hover {
            background: #4a5568;
        }

        .dark-mode .tab-button.active {
            background: #4299e1;
        }

        /* Health Insurance Comparison Layout */
        .health-insurance-comparison {
            width: 100%;
            margin-bottom: 2rem;
        }

        .comparison-table {
            width: 100%;
            margin-bottom: 2rem;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-table th {
            background: #f7fafc;
            font-weight: 600;
            color: #2d3748;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table td:first-child {
            font-weight: 500;
            color: #4a5568;
        }

        .calculation-details {
            background: #f8fafc;
            border-radius: 6px;
            padding: 1.25rem;
            margin-top: 2rem;
            width: 100%;
        }

        .calculation-details h5 {
            color: #2d3748;
            margin: 0 0 1rem 0;
            font-size: 1.1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .calculation-details ul {
            list-style-type: none;
            padding-left: 0;
            margin-bottom: 1rem;
        }

        .calculation-details li {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .calculation-details li:before {
            content: "•";
            color: #4a5568;
            position: absolute;
            left: 0;
        }

        /* Dark mode adjustments */
        body.dark-mode .comparison-table {
            background: #2d3748;
        }

        body.dark-mode .comparison-table th {
            background: #1a202c;
            color: #e2e8f0;
        }

        body.dark-mode .comparison-table td {
            color: #e2e8f0;
            border-color: #4a5568;
        }

        body.dark-mode .comparison-table td:first-child {
            color: #a0aec0;
        }

        body.dark-mode .calculation-details {
            background: #2d3748;
        }

        body.dark-mode .calculation-details h5 {
            color: #e2e8f0;
            border-bottom-color: #4a5568;
        }

        body.dark-mode .calculation-details li:before {
            color: #a0aec0;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg>
    </button>

    <div class="container">
        <header class="header text-center">
            <h1>Foreign Service Benefits Calculator</h1>
            <p>Calculate your benefits based on your service and retirement options</p>
            <div class="disclaimer">
                <p><strong>Disclaimer:</strong> This calculator provides estimates based on publicly available information and should be used for planning purposes only. The actual benefits may vary based on individual circumstances. Please consult with HR for official calculations.</p>
            </div>
        </header>
        <main class="content-wrapper">
            <!-- Left Column - Form -->
            <section class="form-column">
        <form id="calculator-form">
                <!-- Personal Information Section -->
                <div class="form-section" data-step="personal">
                    <h3>Personal Information</h3>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="fs-grade">Grade Level</label>
                            <select id="fs-grade" name="fs-grade" class="form-control" required>
                                <option value="">Select Grade Level</option>
                                <option value="SFS">Senior Foreign Service (SFS)</option>
                                <option value="FS-01">FS-01</option>
                                <option value="FS-02">FS-02</option>
                                <option value="FS-03">FS-03</option>
                                <option value="FS-04">FS-04</option>
                                <option value="FS-05">FS-05</option>
                                <option value="FS-06">FS-06</option>
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="fs-step">Step</label>
                            <select id="fs-step" name="fs-step" class="form-control" required>
                                <option value="">Select Step/Rank</option>
                                <!-- Options will be populated dynamically based on selected grade -->
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="current-age">Current Age</label>
                            <select id="current-age" name="current-age" class="form-control" required>
                                <option value="">Select Age</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                                <option value="32">32</option>
                                <option value="33">33</option>
                                <option value="34">34</option>
                                <option value="35">35</option>
                                <option value="36">36</option>
                                <option value="37">37</option>
                                <option value="38">38</option>
                                <option value="39">39</option>
                                <option value="40">40</option>
                                <option value="41">41</option>
                                <option value="42">42</option>
                                <option value="43">43</option>
                                <option value="44">44</option>
                                <option value="45">45</option>
                                <option value="46">46</option>
                                <option value="47">47</option>
                                <option value="48">48</option>
                                <option value="49">49</option>
                                <option value="50">50</option>
                                <option value="51">51</option>
                                <option value="52">52</option>
                                <option value="53">53</option>
                                <option value="54">54</option>
                                <option value="55">55</option>
                                <option value="56">56</option>
                                <option value="57">57</option>
                                <option value="58">58</option>
                                <option value="59">59</option>
                                <option value="60">60</option>
                                <option value="61">61</option>
                                <option value="62">62</option>
                                <option value="63">63</option>
                                <option value="64">64</option>
                                <option value="65">65</option>
                            </select>
                        </div>
                        <div class="form-group col-md-6">
                            <label for="years-of-service">Years of Service</label>
                            <select id="years-of-service" name="years-of-service" class="form-control" required onchange="validateServiceDuration()">
                                <option value="">Select Years</option>
                                <option value="1">1 year</option>
                                <option value="2">2 years</option>
                                <option value="3">3 years</option>
                                <option value="4">4 years</option>
                                <option value="5">5 years</option>
                                <option value="6">6 years</option>
                                <option value="7">7 years</option>
                                <option value="8">8 years</option>
                                <option value="9">9 years</option>
                                <option value="10">10 years</option>
                                <option value="11">11 years</option>
                                <option value="12">12 years</option>
                                <option value="13">13 years</option>
                                <option value="14">14 years</option>
                                <option value="15">15 years</option>
                                <option value="16">16 years</option>
                                <option value="17">17 years</option>
                                <option value="18">18 years</option>
                                <option value="19">19 years</option>
                                <option value="20">20 years</option>
                                <option value="21">21 years</option>
                                <option value="22">22 years</option>
                                <option value="23">23 years</option>
                                <option value="24">24 years</option>
                                <option value="25">25 years</option>
                                <option value="26">26 years</option>
                                <option value="27">27 years</option>
                                <option value="28">28 years</option>
                                <option value="29">29 years</option>
                                <option value="30">30 years</option>
                                <option value="31">31 years</option>
                                <option value="32">32 years</option>
                                <option value="33">33 years</option>
                                <option value="34">34 years</option>
                                <option value="35">35 years</option>
                                <option value="36">36 years</option>
                                <option value="37">37 years</option>
                                <option value="38">38 years</option>
                                <option value="39">39 years</option>
                                <option value="40">40 years</option>
                            </select>
                            <!-- Service Duration Warning -->
                            <div id="service-duration-warning" class="alert alert-warning" 
                                style="display: none; margin-top: 0.5rem; font-size: 0.85rem; padding: 0.5rem; 
                                background-color: transparent; border: none;">
                                <span id="service-duration-message" style="color: #b91c1c;"></span>
                                <button type="button" class="btn btn-primary btn-sm" onclick="clearSCD()" 
                                    style="padding: 0.25rem 0.5rem; margin-left: 0.5rem; font-size: 0.85rem;">
                                    Clear SCD
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 tooltip">
                            <label for="tera-eligible">V/TERA Offered</label>
                            <select id="tera-eligible" name="tera-eligible" class="form-control">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                        </div>
                        </div>

                    <div id="tera-fields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="tera-years">Years of Service at Retirement</label>
                                <select id="tera-years" name="tera-years" class="form-control">
                                    <option value="15" selected>15 years</option>
                                    <option value="16">16 years</option>
                                    <option value="17">17 years</option>
                                    <option value="18">18 years</option>
                                    <option value="19">19 years</option>
                                    <option value="20">20 years</option>
                                </select>
                                <div class="guidance-note">
                                    <small class="form-text text-muted">
                                        VERA/TERA Minimum: 15 years
                                    </small>
                                </div>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="tera-age">Age at Retirement</label>
                                <select id="tera-age" name="tera-age" class="form-control">
                                    <option value="43" selected>43 years</option>
                                <option value="44">44 years</option>
                                <option value="45">45 years</option>
                                <option value="46">46 years</option>
                                <option value="47">47 years</option>
                                <option value="48">48 years</option>
                                <option value="49">49 years</option>
                                <option value="50">50 years</option>
                            </select>
                                <div class="guidance-note">
                                    <small class="form-text text-muted">
                                        VERA: Minimum age 43
                                        <br>
                                        TERA: No age requirement
                                    </small>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Health Insurance Section -->
                <div class="form-section" data-step="health">
                    <h3>Health Insurance Information</h3>
                        <!-- Health Insurance Plan (full width) -->
                    <div class="form-row">
                            <div class="form-group col-12">
                                <label for="current-plan">Health Insurance Plan</label>
                            <select id="current-plan" name="current-plan" class="form-control" required>
                                    <option value="">Select Plan</option>
                                    <option value="BCBS-basic">BCBS Basic</option>
                                    <option value="FSBP-standard">Foreign Service Benefit Plan</option>
                                    <option value="AETNA-direct">Aetna Direct</option>
                                    <option value="GEHA-standard">GEHA Standard</option>
                                    <option value="Compass Rose">Compass Rose</option>
                            </select>
                        </div>
                    </div>

                        <!-- Enrollment Type and Home State in same row -->
                    <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="coverage-type">Enrollment Type</label>
                                <select id="coverage-type" name="coverage-type" class="form-control" required onchange="updatePlanPrices()">
                                <option value="self">Self Only</option>
                                <option value="self-plus-one">Self Plus One</option>
                                    <option value="family">Self and Family</option>
                            </select>
                        </div>

                            <div class="form-group col-md-6">
                            <label for="state">Home State of Record</label>
                            <select id="state" name="state" class="form-control" required>
                                <option value="">Select a State</option>
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                                    <option value="DC">District of Columbia</option>
                            </select>
                        </div>
                    </div>
                </div>

                    <!-- Advanced Data Entry Section (Optional) -->
                    <div class="form-section">
                        <h3>Advanced Data Entry (Optional)</h3>
                        <div class="form-group">
                            <label for="service-computation-date">Service Computation Date (Optional)</label>
                            <input type="date" id="service-computation-date" name="service-computation-date" class="form-control" 
                                onchange="validateServiceDuration()"
                                title="Enter your Service Computation Date for more accurate calculations">
                            <small class="form-text text-muted">If provided, this will be used instead of Years of Service</small>
                        </div>
                        <div class="form-group">
                            <label for="sick-leave-balance">Sick Leave Balance (hours) (Optional)</label>
                            <input type="number" id="sick-leave-balance" name="sick-leave-balance" class="form-control" placeholder="Enter sick leave balance (optional)" min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label for="annual-leave-balance">Annual Leave Balance (hours) (Optional)</label>
                            <input type="number" id="annual-leave-balance" name="annual-leave-balance" class="form-control" placeholder="Enter annual leave balance" min="0" step="1">
                    </div>
                </div>

                <!-- High-Three Salary Section -->
                <div class="form-section" data-step="salary">
                        <h3>High-Three Salary Information (Optional)</h3>
                        <p class="form-text">Enter your highest three consecutive years of salary including DC locality pay (optional)</p>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="salary-year-1">Year 1 Salary</label>
                            <select id="salary-year-1" name="salary-year-1" class="form-control">
                                <option value="">Select Salary</option>
                                    <option value="50000">$50,000</option>
                                    <option value="55000">$55,000</option>
                                    <option value="60000">$60,000</option>
                                    <option value="65000">$65,000</option>
                                    <option value="70000">$70,000</option>
                                    <option value="75000">$75,000</option>
                                    <option value="80000">$80,000</option>
                                    <option value="85000">$85,000</option>
                                    <option value="90000">$90,000</option>
                                    <option value="95000">$95,000</option>
                                    <option value="100000">$100,000</option>
                                    <option value="105000">$105,000</option>
                                    <option value="110000">$110,000</option>
                                    <option value="115000">$115,000</option>
                                    <option value="120000">$120,000</option>
                                    <option value="125000">$125,000</option>
                                    <option value="130000">$130,000</option>
                                    <option value="135000">$135,000</option>
                                    <option value="140000">$140,000</option>
                                    <option value="145000">$145,000</option>
                                    <option value="150000">$150,000</option>
                                    <option value="155000">$155,000</option>
                                    <option value="160000">$160,000</option>
                                    <option value="165000">$165,000</option>
                                    <option value="170000">$170,000</option>
                                    <option value="175000">$175,000</option>
                                    <option value="180000">$180,000</option>
                                    <option value="185000">$185,000</option>
                                    <option value="190000">$190,000</option>
                                    <option value="195000">$195,000</option>
                                    <option value="200000">$200,000</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="salary-year-2">Year 2 Salary</label>
                            <select id="salary-year-2" name="salary-year-2" class="form-control">
                                <option value="">Select Salary</option>
                                    <option value="50000">$50,000</option>
                                    <option value="55000">$55,000</option>
                                    <option value="60000">$60,000</option>
                                    <option value="65000">$65,000</option>
                                    <option value="70000">$70,000</option>
                                    <option value="75000">$75,000</option>
                                    <option value="80000">$80,000</option>
                                    <option value="85000">$85,000</option>
                                    <option value="90000">$90,000</option>
                                    <option value="95000">$95,000</option>
                                    <option value="100000">$100,000</option>
                                    <option value="105000">$105,000</option>
                                    <option value="110000">$110,000</option>
                                    <option value="115000">$115,000</option>
                                    <option value="120000">$120,000</option>
                                    <option value="125000">$125,000</option>
                                    <option value="130000">$130,000</option>
                                    <option value="135000">$135,000</option>
                                    <option value="140000">$140,000</option>
                                    <option value="145000">$145,000</option>
                                    <option value="150000">$150,000</option>
                                    <option value="155000">$155,000</option>
                                    <option value="160000">$160,000</option>
                                    <option value="165000">$165,000</option>
                                    <option value="170000">$170,000</option>
                                    <option value="175000">$175,000</option>
                                    <option value="180000">$180,000</option>
                                    <option value="185000">$185,000</option>
                                    <option value="190000">$190,000</option>
                                    <option value="195000">$195,000</option>
                                    <option value="200000">$200,000</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="salary-year-3">Year 3 Salary</label>
                            <select id="salary-year-3" name="salary-year-3" class="form-control">
                                <option value="">Select Salary</option>
                                    <option value="50000">$50,000</option>
                                    <option value="55000">$55,000</option>
                                    <option value="60000">$60,000</option>
                                    <option value="65000">$65,000</option>
                                    <option value="70000">$70,000</option>
                                    <option value="75000">$75,000</option>
                                    <option value="80000">$80,000</option>
                                    <option value="85000">$85,000</option>
                                    <option value="90000">$90,000</option>
                                    <option value="95000">$95,000</option>
                                    <option value="100000">$100,000</option>
                                    <option value="105000">$105,000</option>
                                    <option value="110000">$110,000</option>
                                    <option value="115000">$115,000</option>
                                    <option value="120000">$120,000</option>
                                    <option value="125000">$125,000</option>
                                    <option value="130000">$130,000</option>
                                    <option value="135000">$135,000</option>
                                    <option value="140000">$140,000</option>
                                    <option value="145000">$145,000</option>
                                    <option value="150000">$150,000</option>
                                    <option value="155000">$155,000</option>
                                    <option value="160000">$160,000</option>
                                    <option value="165000">$165,000</option>
                                    <option value="170000">$170,000</option>
                                    <option value="175000">$175,000</option>
                                    <option value="180000">$180,000</option>
                                    <option value="185000">$185,000</option>
                                    <option value="190000">$190,000</option>
                                    <option value="195000">$195,000</option>
                                    <option value="200000">$200,000</option>
                            </select>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Calculate Benefits</button>
                <button type="reset" class="btn btn-secondary">Reset Form</button>
            </div>
        </form>
            </section>

            <!-- Right Column - Results -->
            <section class="results-column">
                <div class="results-section">
                    <h3>Results</h3>
        <div class="tabs">
            <div class="tab-buttons">
                            <button class="tab-button active" data-tab="retirement">Retirement</button>
                            <button class="tab-button" data-tab="severance">Severance</button>
                <button class="tab-button" data-tab="health">Health Insurance</button>
                            <button class="tab-button" data-tab="summary">Summary</button>
            </div>
                        <div class="tab-content active" id="retirement-tab">
                            <div id="retirement-scenarios">
                                <!-- Retirement results will be populated here -->
            </div>
            </div>
                        <div class="tab-content" id="severance-tab">
                            <div id="severance-results">
                                <!-- Severance results will be populated here -->
            </div>
        </div>
                        <div class="tab-content" id="health-tab">
                            <div id="health-results" class="health-insurance-comparison">
                                <!-- FEHB and COBRA results will be populated here -->
                            </div>
                        </div>
                        <div class="tab-content" id="summary-tab">
                            <div id="input-summary">
                                <!-- Input summary will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        <footer>
            <p>Developed by Roy Geiser | Foreign Service Benefits Calculator</p>
            <p>This calculator is provided for informational purposes only. Please consult with HR for official calculations.</p>
            <p>© 2024 Roy Geiser. Licensed under the <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer">MIT License</a>.</p>
        </footer>
    </div>

    <script src="./data.js"></script>
    <script src="./calculator.js"></script>
    <script src="./test-calculator.js"></script>
    <script src="./test-ui.js"></script>
    <script src="./script.js"></script>
</body>
</html> 